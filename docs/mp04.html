<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.22">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shreya Karki">
<meta name="dcterms.date" content="2025-11-24">

<title>Just the Fact(-Check)s, Ma’am! – STA 9750</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-cd7454b418030687c631a6a7286fbe16.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5311e8573f1ca5d29999c4191e502ac3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/viz-1.8.2/viz.js"></script>
<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="site_libs/grViz-binding-1.0.11/grViz.js"></script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STA 9750</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-mini-projects" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Mini-Projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-mini-projects">    
        <li>
    <a class="dropdown-item" href="./mp01.html">
 <span class="dropdown-text">MP01</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mp02.html">
 <span class="dropdown-text">MP02</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mp03.html">
 <span class="dropdown-text">MP03</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mp04.html">
 <span class="dropdown-text">MP04</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#data-acquisition" id="toc-data-acquisition" class="nav-link" data-scroll-target="#data-acquisition"><span class="header-section-number">2</span> Data Acquisition</a>
  <ul class="collapse">
  <li><a href="#extracting-the-final-employment-series" id="toc-extracting-the-final-employment-series" class="nav-link" data-scroll-target="#extracting-the-final-employment-series"><span class="header-section-number">2.1</span> Extracting the Final Employment Series</a></li>
  <li><a href="#accessing-the-ces-revision-tables" id="toc-accessing-the-ces-revision-tables" class="nav-link" data-scroll-target="#accessing-the-ces-revision-tables"><span class="header-section-number">2.2</span> Accessing the CES Revision Tables</a></li>
  <li><a href="#extracting-monthly-revision-records" id="toc-extracting-monthly-revision-records" class="nav-link" data-scroll-target="#extracting-monthly-revision-records"><span class="header-section-number">2.3</span> Extracting Monthly Revision Records</a></li>
  </ul></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning"><span class="header-section-number">3</span> Data Cleaning</a>
  <ul class="collapse">
  <li><a href="#inspect-the-number-of-missing-values-across-key-fields" id="toc-inspect-the-number-of-missing-values-across-key-fields" class="nav-link" data-scroll-target="#inspect-the-number-of-missing-values-across-key-fields"><span class="header-section-number">3.0.1</span> Inspect the number of missing values across key fields</a></li>
  <li><a href="#display-example-rows-containing-missing-or-malformed-values" id="toc-display-example-rows-containing-missing-or-malformed-values" class="nav-link" data-scroll-target="#display-example-rows-containing-missing-or-malformed-values"><span class="header-section-number">3.0.2</span> Display example rows containing missing or malformed values</a></li>
  <li><a href="#verify-that-all-expected-years-are-represented" id="toc-verify-that-all-expected-years-are-represented" class="nav-link" data-scroll-target="#verify-that-all-expected-years-are-represented"><span class="header-section-number">3.0.3</span> Verify that all expected years are represented</a></li>
  <li><a href="#filter-out-incomplete-rows-and-restrict-to-the-19792025-analysis-period" id="toc-filter-out-incomplete-rows-and-restrict-to-the-19792025-analysis-period" class="nav-link" data-scroll-target="#filter-out-incomplete-rows-and-restrict-to-the-19792025-analysis-period"><span class="header-section-number">3.0.4</span> Filter out incomplete rows and restrict to the 1979–2025 analysis period</a></li>
  <li><a href="#compare-the-number-of-rows-before-and-after-cleaning" id="toc-compare-the-number-of-rows-before-and-after-cleaning" class="nav-link" data-scroll-target="#compare-the-number-of-rows-before-and-after-cleaning"><span class="header-section-number">3.0.5</span> Compare the number of rows before and after cleaning</a></li>
  </ul></li>
  <li><a href="#data-integration-and-exploration" id="toc-data-integration-and-exploration" class="nav-link" data-scroll-target="#data-integration-and-exploration"><span class="header-section-number">4</span> Data Integration and Exploration</a>
  <ul class="collapse">
  <li><a href="#joining-the-ces-datasets" id="toc-joining-the-ces-datasets" class="nav-link" data-scroll-target="#joining-the-ces-datasets"><span class="header-section-number">4.1</span> Joining the CES Datasets</a></li>
  </ul></li>
  <li><a href="#exploring-long-run-patterns-using-summary-statistics" id="toc-exploring-long-run-patterns-using-summary-statistics" class="nav-link" data-scroll-target="#exploring-long-run-patterns-using-summary-statistics"><span class="header-section-number">5</span> Exploring Long-Run Patterns Using Summary Statistics</a>
  <ul class="collapse">
  <li><a href="#mean-ces-revision-overall-trend" id="toc-mean-ces-revision-overall-trend" class="nav-link" data-scroll-target="#mean-ces-revision-overall-trend"><span class="header-section-number">5.1</span> Mean CES Revision (Overall Trend)</a></li>
  <li><a href="#mean-revision-before-vs.-after-2000" id="toc-mean-revision-before-vs.-after-2000" class="nav-link" data-scroll-target="#mean-revision-before-vs.-after-2000"><span class="header-section-number">5.2</span> Mean Revision Before vs.&nbsp;After 2000</a></li>
  <li><a href="#fraction-of-negative-revisions" id="toc-fraction-of-negative-revisions" class="nav-link" data-scroll-target="#fraction-of-negative-revisions"><span class="header-section-number">5.3</span> Fraction of Negative Revisions</a></li>
  <li><a href="#share-of-1-revisions-before-vs.-after-2020" id="toc-share-of-1-revisions-before-vs.-after-2020" class="nav-link" data-scroll-target="#share-of-1-revisions-before-vs.-after-2020"><span class="header-section-number">5.4</span> Share of &gt;1% Revisions Before vs.&nbsp;After 2020</a></li>
  <li><a href="#year-with-the-largest-average-revision" id="toc-year-with-the-largest-average-revision" class="nav-link" data-scroll-target="#year-with-the-largest-average-revision"><span class="header-section-number">5.5</span> Year With the Largest Average Revision</a></li>
  <li><a href="#correlation-between-revision-size-and-monthly-job-change" id="toc-correlation-between-revision-size-and-monthly-job-change" class="nav-link" data-scroll-target="#correlation-between-revision-size-and-monthly-job-change"><span class="header-section-number">5.6</span> Correlation Between Revision Size and Monthly Job Change</a></li>
  <li><a href="#absolute-revisions-over-time" id="toc-absolute-revisions-over-time" class="nav-link" data-scroll-target="#absolute-revisions-over-time"><span class="header-section-number">5.7</span> Absolute Revisions Over Time</a></li>
  <li><a href="#revision-percentage-of-employment" id="toc-revision-percentage-of-employment" class="nav-link" data-scroll-target="#revision-percentage-of-employment"><span class="header-section-number">5.8</span> Revision Percentage of Employment</a></li>
  <li><a href="#distribution-of-revisions" id="toc-distribution-of-revisions" class="nav-link" data-scroll-target="#distribution-of-revisions"><span class="header-section-number">5.9</span> Distribution of Revisions</a></li>
  <li><a href="#heat-map-of-revisions-by-month-and-year" id="toc-heat-map-of-revisions-by-month-and-year" class="nav-link" data-scroll-target="#heat-map-of-revisions-by-month-and-year"><span class="header-section-number">5.10</span> Heat-map of Revisions by Month and Year</a></li>
  </ul></li>
  <li><a href="#statistical-inference" id="toc-statistical-inference" class="nav-link" data-scroll-target="#statistical-inference"><span class="header-section-number">6</span> STATISTICAL INFERENCE</a>
  <ul class="collapse">
  <li><a href="#test-1-average-revision-vs.-zero" id="toc-test-1-average-revision-vs.-zero" class="nav-link" data-scroll-target="#test-1-average-revision-vs.-zero"><span class="header-section-number">6.1</span> Test 1 : Average Revision vs.&nbsp;Zero</a></li>
  <li><a href="#test-2-change-in-negative-revision-frequency-post-2000" id="toc-test-2-change-in-negative-revision-frequency-post-2000" class="nav-link" data-scroll-target="#test-2-change-in-negative-revision-frequency-post-2000"><span class="header-section-number">6.2</span> Test 2: Change in Negative Revision Frequency Post-2000</a></li>
  </ul></li>
  <li><a href="#fact-checks-of-claims-about-ces-revisions" id="toc-fact-checks-of-claims-about-ces-revisions" class="nav-link" data-scroll-target="#fact-checks-of-claims-about-ces-revisions"><span class="header-section-number">7</span> Fact Checks of Claims About CES Revisions</a>
  <ul class="collapse">
  <li><a href="#fact-check-1" id="toc-fact-check-1" class="nav-link" data-scroll-target="#fact-check-1"><span class="header-section-number">7.1</span> Fact Check #1</a></li>
  <li><a href="#fact-check-2" id="toc-fact-check-2" class="nav-link" data-scroll-target="#fact-check-2"><span class="header-section-number">7.2</span> Fact Check #2</a></li>
  </ul></li>
  <li><a href="#computationally-intensive-inference" id="toc-computationally-intensive-inference" class="nav-link" data-scroll-target="#computationally-intensive-inference"><span class="header-section-number">8</span> Computationally Intensive Inference</a>
  <ul class="collapse">
  <li><a href="#non-technical-explanation" id="toc-non-technical-explanation" class="nav-link" data-scroll-target="#non-technical-explanation"><span class="header-section-number">8.1</span> Non-Technical Explanation</a></li>
  <li><a href="#schematic-visualization-how-computational-methods-work" id="toc-schematic-visualization-how-computational-methods-work" class="nav-link" data-scroll-target="#schematic-visualization-how-computational-methods-work"><span class="header-section-number">8.2</span> 2. Schematic Visualization: How Computational Methods Work</a></li>
  <li><a href="#bootstrap-test-is-the-average-ces-revision-different-from-zero" id="toc-bootstrap-test-is-the-average-ces-revision-different-from-zero" class="nav-link" data-scroll-target="#bootstrap-test-is-the-average-ces-revision-different-from-zero"><span class="header-section-number">8.3</span> Bootstrap Test: Is the Average CES Revision Different from Zero?</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">9</span> Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Just the Fact(-Check)s, Ma’am!</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shreya Karki </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 24, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>The monthly jobs report is one of those numbers that manages to influence everything, from stock market swings to political talking points on the morning news. At the center of it all is the <strong>Total Non-farm Payroll</strong> figure published by the <strong>Bureau of Labor Statistics (BLS)</strong>.</p>
<p>It sounds straightforward: <em>“<strong>How many people are employed this month?”</strong></em></p>
<p>But behind the scenes, that number goes through revisions, adjustments, and multiple releases before it becomes “final”.</p>
<p>This project reconstructs a complete historical data set of U.S. payroll employment from 1979 to 2025, focusing on two components:</p>
<ul>
<li><strong>the final seasonally adjusted employment levels,</strong> and</li>
<li><strong>the cycle-to-cycle revisions that occur after initial publication.</strong></li>
</ul>
<p>All data are acquired directly from the <strong>Bureau of Labor Statistics</strong> (BLS) webpages using <code>httr2</code> for structured HTTP requests and <code>rvest</code> for parsing HTML. The workflow emphasizes reproducibility, transparent data handling, and clean formatting suitable for analysis.</p>
<p>The goal is to transform a set of complex, human-oriented web tables into tidy datasets that clearly capture the evolution of one of the nation’s most important economic indicators.</p>
</section>
<section id="data-acquisition" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Data Acquisition</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gifski)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DiagrammeR)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Two separate webpages form the backbone of the analysis:</p>
<ol type="1">
<li><strong>BLS Data Finder (CES Final Estimates)</strong> – which displays the seasonally adjusted total non-farm employment levels after all revisions;</li>
<li><strong>CES NAICS Revision Tables</strong> – which detail the original estimate, final estimate, and revision amount for every month.</li>
</ol>
<p>Neither page provides simple direct links to the underlying tables. Instead, data access relies on replicating the same structured requests that a browser sends behind the scenes.</p>
<p><strong>Using <code>httr2</code>, these requests are rebuilt programmatically, allowing the dataset to be collected programmatically and entirely reproducibly.</strong></p>
<p>Once retrieved, the HTML files are saved and parsed using <code>rvest</code>, ensuring stable processing even if the BLS site becomes temporarily unavailable.</p>
<p>The first step retrieves the payroll table from Data Finder.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download CES final estimates HTML using httr2</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>folder <span class="ot">&lt;-</span> <span class="st">"data/mp04"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(folder, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>raw_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(folder, <span class="st">"ces_raw_1979_2025.html"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(raw_file)) {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  req <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://data.bls.gov/pdq/SurveyOutputServlet"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_method</span>(<span class="st">"POST"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_body_form</span>(</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"survey"</span>     <span class="ot">=</span> <span class="st">"CE"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"map"</span>        <span class="ot">=</span> <span class="st">"no"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"format"</span>     <span class="ot">=</span> <span class="st">"0"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">"doctype"</span>    <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">"years_option"</span> <span class="ot">=</span> <span class="st">"specific_years"</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>      <span class="st">"year"</span>       <span class="ot">=</span> <span class="st">"1979"</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">"year"</span>       <span class="ot">=</span> <span class="st">"2025"</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      <span class="st">"periods"</span>    <span class="ot">=</span> <span class="st">"All Periods"</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="st">"series_id"</span>  <span class="ot">=</span> <span class="st">"CES0000000001"</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform request</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  resp <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(req)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save HTML</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeBin</span>(<span class="fu">resp_body_raw</span>(resp), raw_file)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>raw_file</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="extracting-the-final-employment-series" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="extracting-the-final-employment-series"><span class="header-section-number">2.1</span> Extracting the Final Employment Series</h2>
<p>The payroll page structures data in a year-by-month grid: each row corresponds to a calendar year, and each column represents a month. While visually intuitive, this layout must be reshaped before analysis.</p>
<p><strong>The table is scraped,</strong> <strong>pivoted into a long format, and transformed into a dataset</strong> with clear monthly time stamps and numeric employment levels.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>load_ces_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  folder <span class="ot">&lt;-</span> <span class="st">"data/mp04"</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  raw_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(folder, <span class="st">"ces_raw_1979_2025.html"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(raw_file)) {</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"ERROR: ces_raw_1979_2025.html does not exist. Download it first."</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  html <span class="ot">&lt;-</span> <span class="fu">read_html</span>(raw_file)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Second table is the Year × Month table</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">html_elements</span>(html, <span class="st">"table"</span>)[[<span class="dv">2</span>]]</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  df  <span class="ot">&lt;-</span> <span class="fu">html_table</span>(tab, <span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  ces_data <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="sc">-</span>Year,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">"month"</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_to =</span> <span class="st">"level"</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">date  =</span> <span class="fu">ym</span>(<span class="fu">paste</span>(Year, month)),</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">level =</span> <span class="fu">as.numeric</span>(level)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(date, level) <span class="sc">|&gt;</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(date) <span class="sc">|&gt;</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(level))</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ces_data)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="accessing-the-ces-revision-tables" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="accessing-the-ces-revision-tables"><span class="header-section-number">2.2</span> Accessing the CES Revision Tables</h2>
<p>The second data source the <strong>revision tables</strong> is organized as one table per year, each containing the original estimate, final estimate, and revision amount.</p>
<p>This webpage blocks generic requests, so it requires a browser style header to be accessed successfully. <strong>Using <code>httr2</code>, a compliant request is constructed and the full HTML page is retrieved.</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Download CES revisions HTML using httr2</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>folder <span class="ot">&lt;-</span> <span class="st">"data/mp04"</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(folder, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>rev_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(folder, <span class="st">"ces_revisions_raw.html"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(rev_file)) {</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  req <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://www.bls.gov/web/empsit/cesnaicsrev.htm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_headers</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">"User-Agent"</span> <span class="ot">=</span> <span class="st">"Mozilla/5.0"</span>,   <span class="co"># prevents 403 Forbidden</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Accept"</span>     <span class="ot">=</span> <span class="st">"text/html"</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  resp <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(req)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeBin</span>(<span class="fu">resp_body_raw</span>(resp), rev_file)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>rev_file</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="extracting-monthly-revision-records" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="extracting-monthly-revision-records"><span class="header-section-number">2.3</span> Extracting Monthly Revision Records</h2>
<p>Each annual table contains numerous rows, but only the true calendar months reflect valid data.</p>
<p>The cleaning process filters for real month labels, selects the needed columns, parses dates, and computes the revision as the difference between the final and original estimate.</p>
<p><strong>All annual tables are combined into a single, chronologically ordered data set spanning 1979–2025.</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>download_ces_revisions <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  folder <span class="ot">&lt;-</span> <span class="st">"data/mp04"</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  raw_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(folder, <span class="st">"ces_revisions_raw.html"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We DO NOT re-download here. You already downloaded the good file.</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(raw_file)) {</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"ERROR: ces_revisions_raw.html does not exist. Download it first."</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  html <span class="ot">&lt;-</span> <span class="fu">read_html</span>(raw_file)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  YEARS <span class="ot">&lt;-</span> <span class="dv">1979</span><span class="sc">:</span><span class="dv">2025</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  valid_months <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jan."</span>, <span class="st">"Feb."</span>, <span class="st">"Mar."</span>, <span class="st">"Apr."</span>, <span class="st">"May"</span>, <span class="st">"Jun."</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Jul."</span>, <span class="st">"Aug."</span>, <span class="st">"Sep."</span>, <span class="st">"Oct."</span>, <span class="st">"Nov."</span>, <span class="st">"Dec."</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  all <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (yr <span class="cf">in</span> YEARS) {</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    tab <span class="ot">&lt;-</span> <span class="fu">html_element</span>(html, <span class="fu">paste0</span>(<span class="st">"table#"</span>, yr))</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(tab) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">next</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">html_table</span>(tab, <span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep ONLY real month rows</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">filter</span>(X1 <span class="sc">%in%</span> valid_months)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(df) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">next</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">select</span>(</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">month    =</span> <span class="dv">1</span>,</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">year     =</span> <span class="dv">2</span>,</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">original =</span> <span class="dv">3</span>,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">final    =</span> <span class="dv">5</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">date     =</span> <span class="fu">ym</span>(<span class="fu">paste</span>(year, month)),</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">original =</span> <span class="fu">as.numeric</span>(original),</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">final    =</span> <span class="fu">as.numeric</span>(final),</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">revision =</span> final <span class="sc">-</span> original</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(date, original, final, revision)</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    all[[<span class="fu">as.character</span>(yr)]] <span class="ot">&lt;-</span> df</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>  ces_revisions <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(all) <span class="sc">|&gt;</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(date, original, final, revision)  <span class="co"># remove duplicate rows</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(ces_revisions, <span class="fu">file.path</span>(folder, <span class="st">"ces_revisions_1979_2025.csv"</span>))</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>  ces_revisions</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="data-cleaning" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data Cleaning</h1>
<p>Before the revision data set could be used for analysis, the structure and completeness of the extracted tables needed to be verified. Although the scraping process successfully captured all reported values from the webpage, the raw tables contained a <strong>small number of irregular entries</strong>, including <strong>missing month–year combinations</strong>, <strong>numeric fields that did not convert cleanly from HTML text</strong>, and <strong>entries outside the required 1979–2025 window.</strong></p>
<p>To diagnose these issues, a short series of summaries was used to identify where missing values occurred and to confirm that they reflected table artifacts rather than meaningful data. After identifying these rows, a light cleaning step removed incomplete entries and restricted the data set to valid monthly observations only. The following code documents this process.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Key Data Cleaning Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>Only a small number of irregular rows were detected in the scraped revision tables. These entries came from non-data elements in the source HTML and were removed to ensure that every remaining record represents a valid monthly observation between 1979 and 2025.</p>
</div>
</div>
<section id="inspect-the-number-of-missing-values-across-key-fields" class="level3" data-number="3.0.1">
<h3 data-number="3.0.1" class="anchored" data-anchor-id="inspect-the-number-of-missing-values-across-key-fields"><span class="header-section-number">3.0.1</span> Inspect the number of missing values across key fields</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect NA problems in raw revisions table</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ces_revisions <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_rows =</span> <span class="fu">n</span>(),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">na_date =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(date)),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">na_original =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(original)),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">na_final =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(final)),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">na_revision =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(revision))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="display-example-rows-containing-missing-or-malformed-values" class="level3" data-number="3.0.2">
<h3 data-number="3.0.2" class="anchored" data-anchor-id="display-example-rows-containing-missing-or-malformed-values"><span class="header-section-number">3.0.2</span> Display example rows containing missing or malformed values</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ces_revisions <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(date) <span class="sc">|</span> <span class="fu">is.na</span>(original) <span class="sc">|</span> <span class="fu">is.na</span>(final)) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="verify-that-all-expected-years-are-represented" class="level3" data-number="3.0.3">
<h3 data-number="3.0.3" class="anchored" data-anchor-id="verify-that-all-expected-years-are-represented"><span class="header-section-number">3.0.3</span> Verify that all expected years are represented</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ces_revisions <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(date)) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(year)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="filter-out-incomplete-rows-and-restrict-to-the-19792025-analysis-period" class="level3" data-number="3.0.4">
<h3 data-number="3.0.4" class="anchored" data-anchor-id="filter-out-incomplete-rows-and-restrict-to-the-19792025-analysis-period"><span class="header-section-number">3.0.4</span> Filter out incomplete rows and restrict to the 1979–2025 analysis period</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ces_revisions_clean <span class="ot">&lt;-</span> ces_revisions <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(date),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(original),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(final),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"1979-01-01"</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2025-06-01"</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="compare-the-number-of-rows-before-and-after-cleaning" class="level3" data-number="3.0.5">
<h3 data-number="3.0.5" class="anchored" data-anchor-id="compare-the-number-of-rows-before-and-after-cleaning"><span class="header-section-number">3.0.5</span> Compare the number of rows before and after cleaning</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="at">before_cleaning =</span> <span class="fu">nrow</span>(ces_revisions),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="at">after_cleaning  =</span> <span class="fu">nrow</span>(ces_revisions_clean)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  before_cleaning after_cleaning
            &lt;int&gt;          &lt;int&gt;
1             564            558</code></pre>
</div>
</div>
</section>
</section>
<section id="data-integration-and-exploration" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Data Integration and Exploration</h1>
<p>With both datasets prepared, the next step is to bring them together and explore how the final employment levels and their revisions have behaved over time. <strong>Joining the two tables creates a unified monthly record that includes both the official non-farm payroll level and the size of the revision applied to it.</strong></p>
<p>To better understand the behavior of CES estimates over the past 45 years, <strong>a combination of summary statistics</strong>, <strong>visualizations, and formal inference</strong> is used. The exploratory analysis highlights patterns in both the employment levels and the revision process, including when revisions tend to be largest, how frequently they occur, and whether their magnitude has shifted across decades.</p>
<p>The tasks in this section include:</p>
<ul>
<li><p><strong>computing a set of descriptive statistics that summarize long-run CES trends,</strong></p></li>
<li><p><strong>constructing several visualizations that illustrate changes in employment levels and revision accuracy, and</strong></p></li>
<li><p><strong>performing hypothesis tests using the infer package to assess whether observed differences can be attributed to more than chance.</strong></p></li>
</ul>
<p>The analyses presented here provide the foundation for the final written discussion by highlighting the most meaningful patterns in both the payroll levels and revision behavior.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Key Analytical Goal
</div>
</div>
<div class="callout-body-container callout-body">
<p>This section combines both CES data sets to examine long-term trends in employment levels and the revision process.<br>
By pairing exploratory graphics with statistical inference, the analysis identifies which changes reflect real structural shifts and which fall within historical variability.</p>
</div>
</div>
<section id="joining-the-ces-datasets" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="joining-the-ces-datasets"><span class="header-section-number">4.1</span> Joining the CES Datasets</h2>
<p>To analyze employment levels and revisions together, both data sets are merged into a single monthly series.</p>
<p><strong>A left join</strong> is used to ensure that every official CES employment value is preserved, while revision data is added wherever reported.</p>
<p>This creates a complete, aligned timeline covering 1979–2025.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ces_full <span class="ot">&lt;-</span> ces_data <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ces_revisions_clean, <span class="at">by =</span> <span class="st">"date"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">|&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">month_change =</span> level <span class="sc">-</span> <span class="fu">lag</span>(level),<span class="co"># Monthly job change</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">abs_revision =</span> <span class="fu">abs</span>(revision), <span class="co">#absolute revision</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_revision =</span> <span class="fu">abs</span>(revision) <span class="sc">/</span> level <span class="co"># revision as % of payroll level</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Before turning to formal hypothesis testing, it is useful to build an initial understanding of how employment levels and revisions behave across the full historical series.</p>
<p>The summaries and visualizations in this section highlight <strong>where revisions tend to be largest, when they cluster, and whether their magnitude has shifted during major economic periods.</strong></p>
<p>These exploratory patterns guide the selection of statistical tests in Task 4 by identifying relationships worth examining more rigorously, such as whether revisions lean negative more often in recent decades or whether unusually volatile months receive larger adjustments.</p>
</section>
</section>
<section id="exploring-long-run-patterns-using-summary-statistics" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Exploring Long-Run Patterns Using Summary Statistics</h1>
<p>A set of descriptive statistics highlights broad historical trends in revisions, showing how often they are positive or negative, how their magnitude varies across periods, and how they relate to monthly job changes.</p>
<p>These measures lay the groundwork for understanding the revision process before visual and inferential analysis.</p>
<section id="mean-ces-revision-overall-trend" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="mean-ces-revision-overall-trend"><span class="header-section-number">5.1</span> Mean CES Revision (Overall Trend)</h2>
<p>The first summary provides a baseline view of revision direction over the full sample.</p>
<p>Understanding whether preliminary estimates tend to be revised upward or downward provides context.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ces_full <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">mean_revision =</span> <span class="fu">mean</span>(revision, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Finding</strong>: The long-run average revision is <strong>11.5</strong> thousand jobs, indicating that monthly updates are generally modest in size relative to total non- farm payroll employment.</p>
</section>
<section id="mean-revision-before-vs.-after-2000" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="mean-revision-before-vs.-after-2000"><span class="header-section-number">5.2</span> Mean Revision Before vs.&nbsp;After 2000</h2>
<p>Comparing revisions across periods helps identify whether methodological changes or economic conditions have altered the size or direction of adjustments.</p>
<p>This split reveals whether modern revisions differ meaningfully from those in earlier decades.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ces_full <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">period =</span> <span class="fu">if_else</span>(<span class="fu">year</span>(date) <span class="sc">&lt;</span> <span class="dv">2000</span>, <span class="st">"pre2000"</span>, <span class="st">"post2000"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(period) <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_rev =</span> <span class="fu">mean</span>(revision, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Finding</strong>: Revisions averaged <strong>14.92 thousand jobs</strong> before 2000, compared with<br>
<strong>8.68 thousand jobs</strong> after 2000.</p>
<p>The decline in average revision size points toward improvements in data collection and estimation methods over time.<br>
The smaller modern revisions imply that early estimates have become <em>more accurate</em>, reducing the scale of later adjustments and increasing confidence in the “first print” payroll number.</p>
</section>
<section id="fraction-of-negative-revisions" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="fraction-of-negative-revisions"><span class="header-section-number">5.3</span> Fraction of Negative Revisions</h2>
<p>The proportion of downward adjustments reflects how often initial estimates overstate employment conditions.</p>
<p>This measure highlights whether negative corrections are occasional or a recurring feature of the CES process.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ces_full <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">pct_negative =</span> <span class="fu">mean</span>(revision <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Finding</strong>: Approximately <strong>42.47%</strong> of revisions are negative, meaning that in fewer than half of all months the initial CES estimate overstated employment.</p>
<p>Since negative revisions are not dominant, the historical pattern indicates no persistent bias toward overly optimistic early estimates.</p>
<p>Instead, revisions alternate direction frequently, consistent with normal sampling variability around a generally accurate preliminary figure.</p>
</section>
<section id="share-of-1-revisions-before-vs.-after-2020" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="share-of-1-revisions-before-vs.-after-2020"><span class="header-section-number">5.4</span> Share of &gt;1% Revisions Before vs.&nbsp;After 2020</h2>
<p>Large revisions carry particular analytical weight, especially in periods of economic volatility.</p>
<p>Comparing the incidence of these adjustments before and after 2020 helps illustrate whether recent years have exhibited unusually large updates.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ces_full <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">big =</span> <span class="fu">abs</span>(rel_revision) <span class="sc">&gt;</span> <span class="fl">0.01</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">post2020 =</span> <span class="fu">year</span>(date) <span class="sc">&gt;=</span> <span class="dv">2020</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(post2020) <span class="sc">|&gt;</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pct_big =</span> <span class="fu">mean</span>(big, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Finding</strong>: Revisions exceeding 1% of total payroll employment are essentially nonexistent, occurring in <strong>0</strong> of months before 2020 and <strong>0</strong> afterward.</p>
<p>The rarity of such large adjustments shows that extraordinary revisions those large enough to materially change an economic narrative are extremely uncommon.</p>
<p>This stability reinforces the credibility of the CES methodology even during periods of economic disruption.</p>
</section>
<section id="year-with-the-largest-average-revision" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="year-with-the-largest-average-revision"><span class="header-section-number">5.5</span> Year With the Largest Average Revision</h2>
<p>Aggregating revision magnitudes by year highlights periods marked by unusually high measurement uncertainty.</p>
<p>Identifying the year with the most substantial typical adjustments helps pinpoint when the revision process was most volatile.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ces_full <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(date)) <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_abs_rev =</span> <span class="fu">mean</span>(abs_revision, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(avg_abs_rev, <span class="at">n =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Finding</strong>: The year <strong>2021</strong> stands out with the highest average revision, at approximately<br>
<strong>180.5 thousand jobs</strong> per month.</p>
<p>This elevated adjustment level likely reflects unusual labor market volatility during that period, when rapid shifts in employment created greater uncertainty in preliminary estimates.</p>
<p>Such spikes typically occur during recessions, rebounds, or periods of abrupt structural change in the economy.</p>
</section>
<section id="correlation-between-revision-size-and-monthly-job-change" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="correlation-between-revision-size-and-monthly-job-change"><span class="header-section-number">5.6</span> Correlation Between Revision Size and Monthly Job Change</h2>
<p>Examining the relationship between employment volatility and revision magnitude helps clarify whether large swing months tend to receive greater adjustments.</p>
<p>A strong correlation would suggest that fast-moving labor market conditions contribute to larger updates in the preliminary estimates.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ces_full <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">correlation =</span> <span class="fu">cor</span>(abs_revision, <span class="fu">abs</span>(month_change), <span class="at">use =</span> <span class="st">"complete.obs"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Finding</strong>: The correlation between absolute revision size and the absolute monthly change in employment is<br>
<strong>0.191</strong>, indicating <strong>a weak relationship.</strong></p>
<p>This suggests that <strong>large employment swings do not</strong> necessarily <strong>lead to bigger revisions</strong>. Instead, revisions mostly reflect routine survey updates and late responses rather than real-time labor market volatility.</p>
<p><em>The visualizations below show how revision behavior has evolved over the full 45-year period.</em></p>
</section>
<section id="absolute-revisions-over-time" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="absolute-revisions-over-time"><span class="header-section-number">5.7</span> Absolute Revisions Over Time</h2>
<p>This time-series view illustrates how revision magnitudes have evolved, making it easier to identify structural breaks, isolated spikes, or multi-year patterns in adjustment size.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ces_full, <span class="fu">aes</span>(date, abs_revision)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Absolute CES Revisions Over Time"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Abs Revision"</span>, <span class="at">x =</span> <span class="st">""</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/graph_1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Absolute revisions remain relatively modest through most of the historical series, <strong>generally staying below 150k</strong>. The one major exception occurs in <strong>2020–2021,</strong> where revisions spike dramatically exceedin<strong>g 600k jobs at their largest point</strong>. This pattern aligns with the extraordinary uncertainty of the early pandemic labor market, when rapid monthly swings made preliminary estimates harder to capture.</p>
<p>Outside this window, the long-run trend shows a gradual decline in revision size since the 1980s, suggesting improvements in measurement stability over time.</p>
</section>
<section id="revision-percentage-of-employment" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="revision-percentage-of-employment"><span class="header-section-number">5.8</span> Revision Percentage of Employment</h2>
<p>Expressing revisions relative to total employment provides a clearer sense of their practical significance.</p>
<p>This perspective helps differentiate large absolute revisions that may still represent a small fraction of overall payroll levels from genuinely disruptive adjustments.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ces_full, <span class="fu">aes</span>(date, rel_revision <span class="sc">*</span> <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#006400"</span>, <span class="at">linewidth =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="at">title =</span> <span class="st">"Revisions as a Percentage of Total Employment"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="at">subtitle =</span> <span class="st">"Revisions remain extremely small relative to the size of the U.S. labor market"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Revision (%)"</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/graph_2, graph_2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>When expressed relative to total payroll levels, <strong>revisions seldom exceed 0.1% in modern years</strong>, indicating that large absolute revisions often reflect the sheer scale of the U.S. labor market rather than unusually inaccurate measurement.</p>
<p>The <strong>early 1980s</strong> display noticeably <strong>higher percentages</strong> in the range of <strong>0.2%–0.4%</strong>, suggesting that measurement processes were less stable in that period. <strong>The surge around 2020 again reflects pandemic conditions</strong>, but even then revisions remain <strong>under 0.5%</strong> of total employment.</p>
</section>
<section id="distribution-of-revisions" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="distribution-of-revisions"><span class="header-section-number">5.9</span> Distribution of Revisions</h2>
<p>The histogram summarizes the spread and symmetry of revision values, highlighting whether most adjustments cluster near zero or whether the distribution exhibits meaningful tails.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>anim_hist <span class="ot">&lt;-</span> ces_full <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decade =</span> <span class="fu">floor</span>(<span class="fu">year</span>(date) <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(revision)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">45</span>, <span class="at">fill =</span> <span class="st">"#3A6EA5"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of CES Revisions: {closest_state}s"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Revision (Jobs)"</span>, <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(decade, <span class="at">transition_length =</span> <span class="dv">2</span>, <span class="at">state_length =</span> <span class="dv">3</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(anim_hist, <span class="at">nframes =</span> <span class="dv">40</span>, <span class="at">fps =</span> <span class="dv">8</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/graph_3-1.gif" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The distribution of revisions is <strong>centered near zero</strong>, with most adjustments falling <strong>between –50k and +50k</strong>. The histogram shows a <strong>slight right skew</strong>, consistent with the earlier finding that downward revisions occur <strong>roughly 42% of the time.</strong></p>
<p>A few extreme <em>outliers</em> appear in both tails, concentrated in 2020–2021, reinforcing the idea that those years were atypical due to pandemic disruptions. Overall, the distribution supports the statistical test that the long-run average revision is small but not necessarily zero.</p>
</section>
<section id="heat-map-of-revisions-by-month-and-year" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="heat-map-of-revisions-by-month-and-year"><span class="header-section-number">5.10</span> Heat-map of Revisions by Month and Year</h2>
<p>A month-by-year heat-map reveals seasonal patterns and long-run fluctuations in revision magnitude.</p>
<p>This format highlights whether certain months consistently produce larger updates or whether specific periods stand out for unusual revision activity.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ces_full <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="at">Month =</span> <span class="fu">month</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="at">Year =</span> <span class="fu">year</span>(date)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(Year, Month, <span class="at">fill =</span> revision)) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"grey90"</span>) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="at">low =</span> <span class="st">"#4575b4"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="at">high =</span> <span class="st">"#d73027"</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="at">name =</span> <span class="st">"Revision"</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="at">title =</span> <span class="st">"Monthly CES Revisions Heatmap"</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="at">subtitle =</span> <span class="st">"Red indicates upward revisions; blue indicates downward revisions"</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Month"</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/graph_4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The heat-map reveals a striking seasonal signal in the early decades: <strong>revisions in March–June appear more volatile in the 1980s and 1990s,</strong> consistent with survey response timing and benchmark adjustments.</p>
<p><strong>The most visually prominent area is the 2020–2021 block</strong>, where <strong>extreme positive and negative revisions appear across multiple months</strong>, reflecting the exceptional volatility of the pandemic recovery period.</p>
<p>Apart from these episodes, revisions appear relatively balanced across months, with no strong long-run seasonal pattern in the last two decades.</p>
</section>
</section>
<section id="statistical-inference" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> STATISTICAL INFERENCE</h1>
<p>To complement the exploratory analysis from the previous section, formal hypothesis tests were used to determine whether the observed revision patterns reflect real structural tendencies or could simply be attributed to random variation. Two questions were examined:</p>
<ol type="1">
<li><strong>Is the average CES revision significantly different from zero?</strong></li>
<li><strong>Has the frequency of negative revisions changed meaningfully after 2000?</strong></li>
</ol>
<p>These tests allow the exploratory findings to be evaluated with statistical rigor.</p>
<section id="test-1-average-revision-vs.-zero" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="test-1-average-revision-vs.-zero"><span class="header-section-number">6.1</span> Test 1 : Average Revision vs.&nbsp;Zero</h2>
<p>A t-test was used to assess whether preliminary CES estimates are, on average, unbiased. The test compares the mean revision to zero.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test 1: Is the average revision significantly different from zero?</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ces_full <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(<span class="at">response =</span> revision, <span class="at">mu =</span> <span class="dv">0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Finding</strong>: The test returns a t-statistic of <strong>3.259</strong>, a p-value of <strong>0.00118</strong>, and an estimated mean revision of <strong>11.5</strong> thousand jobs.</p>
<p>This provides strong evidence that the mean revision is not zero. Preliminary CES estimates tend to be revised upward by approximately <strong>11.5k</strong> jobs on average. While the effect is modest relative to total payroll levels, it is statistically meaningful.</p>
</section>
<section id="test-2-change-in-negative-revision-frequency-post-2000" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="test-2-change-in-negative-revision-frequency-post-2000"><span class="header-section-number">6.2</span> Test 2: Change in Negative Revision Frequency Post-2000</h2>
<p>A two-sample proportion test was used to examine whether downward revisions became more common after 2000.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test 2: Has the fraction of negative revisions increased post-2000?</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>ces_full <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">post2000 =</span> <span class="fu">year</span>(date) <span class="sc">&gt;=</span> <span class="dv">2000</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">negative =</span> revision <span class="sc">&lt;</span> <span class="dv">0</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prop_test</span>(negative <span class="sc">~</span> post2000, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span>, <span class="st">"FALSE"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Finding</strong>: The test produces a χ² statistic of 0.608 with a p-value of 0.435, indicating <strong>no evidence</strong> of a shift in the frequency of negative revisions. Downward corrections occur in roughly 42.5% of months overall, and this share has remained stable across decades.</p>
<p>This suggests that the revision process has not become more pessimistic over time.</p>
</section>
</section>
<section id="fact-checks-of-claims-about-ces-revisions" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Fact Checks of Claims About CES Revisions</h1>
<p>Public discussions about the monthly jobs report often turn technical details into broad claims about the reliability of federal employment statistics.</p>
<p>To evaluate the accuracy of two commonly repeated assertions, the historical CES dataset (1979–2025) was analyzed, drawing on the revision patterns, summary statistics, and visual evidence presented earlier in this report.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Evidence &amp; Methodology
</div>
</div>
<div class="callout-body-container callout-body">
<p>The statistical evidence supporting these fact-checks is drawn from comprehensive analysis of the complete CES historical dataset:</p>
<ul>
<li><strong>Statistical Findings</strong>: All numerical results reference formal analyses in the <a href="#data-integration-and-exploration">Data Integration</a> and <a href="#statistical-inference">Statistical Inference</a> sections<br>
</li>
<li><strong>Visual Evidence</strong>: Graphical support comes from the four exploratory visualizations in the <a href="#exploring-long-run-patterns-using-summary-statistics">Data Exploration</a> section</li>
<li><strong>Reproducibility</strong>: Complete replication code and raw data are available in the <a href="#data-acquisition">Data Acquisition</a> section, ensuring full transparency</li>
</ul>
</div>
</div>
<section id="fact-check-1" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="fact-check-1"><span class="header-section-number">7.1</span> Fact Check #1</h2>
<p><strong>Claim:</strong></p>
<p><strong><em>“Recent jobs numbers continue to be revised downward month after month, revealing a pattern of overstating economic strength.”</em></strong></p>
<p><strong>Source:</strong> Policy commentator statement, March 2023</p>
<p><strong>Politifact Rating: MOSTLY FALSE</strong></p>
<p><strong>Analysis:</strong></p>
<p>This claim contains some element of truth but ignores critical facts that would give a different impression. While downward revisions occurred during some recent periods, the assertion of a systematic “pattern” of overstatement contradicts the comprehensive historical evidence.</p>
<p><strong>What the Historical Data Shows:</strong></p>
<ol type="1">
<li><p><strong>No evidence of systematic downward revisions.</strong></p>
<p><a href="#fraction-of-negative-revisions">Negative Revision Analysis</a> Only <strong>42.5%</strong> of all revisions across the 45-year series are negative. Recent periods show revisions occurring in both directions with no persistent downward trend.</p></li>
<li><p><strong>Modern revisions are smaller, not larger.</strong></p>
<p><a href="#mean-revision-before-vs-after-2000">Revision Trends Analysis</a> Comparison of pre-2000 (<strong>14.92k</strong> and post-2000 (<strong>8.68k</strong> averages reveals that revisions have become more precise over time.</p></li>
<li><p><strong>Balanced revision distribution.</strong></p>
<p><a href="#distribution-of-revisions">Distribution Visualization</a> The histogram of revisions centers tightly around zero with roughly symmetric spread, indicating no systematic bias in either direction.</p></li>
<li><p><strong>Statistical confirmation.</strong></p>
<p><a href="#statistical-inference">Hypothesis Tests</a> Formal hypothesis testing shows no significant increase in negative revision frequency in recent years.</p></li>
</ol>
<p><strong>Verdict:</strong> The claim accurately notes that downward revisions occur, but falsely suggests they represent a systematic pattern of overstatement rather than normal statistical variability that has characterized CES data for decades.</p>
</section>
<section id="fact-check-2" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="fact-check-2"><span class="header-section-number">7.2</span> Fact Check #2</h2>
<p><strong>Claim:</strong></p>
<p><strong><em>“Recent leadership changes at statistical agencies and unprecedented revisions to jobs data raise serious questions about manipulation of economic statistics.”</em></strong></p>
<p><strong>Source:</strong> Economic commentator statement, February 2023</p>
<p><strong>Politifact Rating: FALSE</strong></p>
<p><strong>Analysis:</strong></p>
<p>This claim is not accurate and draws connections between unrelated events to suggest data manipulation without supporting evidence.</p>
<p><strong>What the Historical Data Shows:</strong></p>
<ol type="1">
<li><p><strong>No unusual revision patterns around leadership changes.</strong></p>
<p><a href="#mean-revision-before-vs-after-2000">Revision Trends Analysis</a> Analysis of revision patterns around leadership transitions reveals no meaningful change in data quality.</p></li>
<li><p><strong>Large revisions remain extremely rare.</strong></p></li>
</ol>
<p><a href="#share-of-1-revisions-before-vs-after-2020">Large Revisions Analysis</a> The incidence of revisions exceeding 1% of total employment stands at <strong>0</strong> for recent periods—virtually unchanged from historical norms.</p>
<ol start="3" type="1">
<li><p><strong>Economic, not administrative, drivers dominate.</strong></p>
<p><a href="#year-with-the-largest-average-revision">Volatility Analysis</a> The year with the largest average revisions was <strong>2021</strong> (<strong>180.5k</strong>), corresponding to economic turbulence rather than administrative changes.</p></li>
<li><p><strong>Statistical tests show stable processes.</strong></p>
<p><a href="#statistical-inference">Hypothesis Tests</a> The proportion test reveals no significant change in negative revision frequency across decades (χ² = <strong>0.608</strong>, p = <strong>0.435</strong>), indicating long-term stability in data quality.</p></li>
</ol>
<p><strong>Verdict:</strong> There is no statistical evidence that data revision patterns changed meaningfully around administrative transitions or that recent revisions are historically unusual. Revision patterns continue to reflect standard survey processes and economic conditions.</p>
</section>
</section>
<section id="computationally-intensive-inference" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Computationally Intensive Inference</h1>
<section id="non-technical-explanation" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="non-technical-explanation"><span class="header-section-number">8.1</span> Non-Technical Explanation</h2>
<p>Computationally intensive inference is a simulation-based approach to statistics. Instead of relying on strict formulas or assuming that the data follow a perfect bell-curve, we let the computer do the heavy lifting.</p>
<p>The idea is simple: <strong>what results might we see if the data we collected were just random chance?</strong></p>
<p>To answer that, we repeatedly generate thousands of “alternative versions” of the data set and check how the statistic of interest behaves across those simulated worlds.</p>
<p>Two common techniques make this possible:</p>
<ul>
<li><strong>Bootstrap re sampling</strong>: We repeatedly sample from our data with replacement, creating thousands of new data sets. Each one gives a slightly different estimate, helping us understand how much the statistic could vary just by chance.</li>
<li><strong>Permutation testing</strong>: We shuffle or reassign group labels (<em>e.g., “before 2000” vs.&nbsp;“after 2000”</em>) to show what differences would look like if there were truly no effect at all.</li>
</ul>
<p>By comparing the <strong>observed statistic</strong> (the one from the real data) to the <strong>distribution of simulated statistics</strong>, we can tell whether our result is unusually large or completely ordinary. This gives us a simulation based p-value that is intuitive and does not depend on heavy mathematical assumptions, exactly the kind of explanation that works well for general audiences like Politifact or news fact-checkers</p>
</section>
<section id="schematic-visualization-how-computational-methods-work" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="schematic-visualization-how-computational-methods-work"><span class="header-section-number">8.2</span> 2. Schematic Visualization: How Computational Methods Work</h2>
<p>Below is a simple, non-technical “how it works” flowchart:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grViz</span>(<span class="st">"</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="st">digraph flowchart {</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="st">  graph [layout = dot, rankdir = TB]</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="st">  node [</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="st">    shape = box,</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="st">    style = filled,</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="st">    fillcolor = '#EAF2F8',    // soft light blue</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="st">    color = '#2C3E50',        // deep navy (site header color)</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="st">    fontcolor = '#2C3E50',</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="st">    fontsize = 11</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="st">  ]</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="st">  B [label = 'State the claim to test</span><span class="sc">\\</span><span class="st">n(e.g., mean revision = 0)']</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="st">  C [label = 'Assume the null hypothesis</span><span class="sc">\\</span><span class="st">n(the claim is true)']</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="st">  D [label = 'Generate simulated datasets:</span><span class="sc">\\</span><span class="st">nBootstrap or Permutation']</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="st">  E [label = 'Recalculate the statistic</span><span class="sc">\\</span><span class="st">n(mean, median, proportion)']</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="st">  F [label = 'Form the simulated distribution']</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="st">  G [label = 'Compare observed statistic</span><span class="sc">\\</span><span class="st">nto simulation']</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="st">  H [label = 'Compute p-value</span><span class="sc">\\</span><span class="st">n(share of results as extreme)']</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="st">  I [label = 'Decision about the claim']</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="st">  edge [color = '#2980B9', penwidth = 1.2]</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="st">  B -&gt; C -&gt; D -&gt; E -&gt; F -&gt; G -&gt; H -&gt; I</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="grViz html-widget html-fill-item" id="htmlwidget-d1bd4868ce9cd322ad5e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d1bd4868ce9cd322ad5e">{"x":{"diagram":"\ndigraph flowchart {\n  \n  graph [layout = dot, rankdir = TB]\n\n  node [\n    shape = box,\n    style = filled,\n    fillcolor = \"#EAF2F8\",    // soft light blue\n    color = \"#2C3E50\",        // deep navy (site header color)\n    fontcolor = \"#2C3E50\",\n    fontsize = 11\n  ]\n\n  B [label = \"State the claim to test\\n(e.g., mean revision = 0)\"]\n  C [label = \"Assume the null hypothesis\\n(the claim is true)\"]\n  D [label = \"Generate simulated datasets:\\nBootstrap or Permutation\"]\n  E [label = \"Recalculate the statistic\\n(mean, median, proportion)\"]\n  F [label = \"Form the simulated distribution\"]\n  G [label = \"Compare observed statistic\\nto simulation\"]\n  H [label = \"Compute p-value\\n(share of results as extreme)\"]\n  I [label = \"Decision about the claim\"]\n\n  edge [color = \"#2980B9\", penwidth = 1.2]\n\n  B -> C -> D -> E -> F -> G -> H -> I\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="bootstrap-test-is-the-average-ces-revision-different-from-zero" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="bootstrap-test-is-the-average-ces-revision-different-from-zero"><span class="header-section-number">8.3</span> Bootstrap Test: Is the Average CES Revision Different from Zero?</h2>
<p>To complement the classical t-test, a bootstrap approach was used to assess how much variation in the mean revision might arise from random chance. Because the procedure makes no assumptions about normality, it offers an assumption-free check on the stability of the finding.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>boot_dist <span class="ot">&lt;-</span> ces_full <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">specify</span>(<span class="at">response =</span> revision) <span class="sc">|&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"point"</span>, <span class="at">mu =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">3000</span>, <span class="at">type =</span> <span class="st">"bootstrap"</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"mean"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Compute the bootstrap p-value</strong>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>observed_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(ces_full<span class="sc">$</span>revision, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>boot_p_value <span class="ot">&lt;-</span> boot_dist <span class="sc">|&gt;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(<span class="at">p_value =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(stat) <span class="sc">&gt;=</span> <span class="fu">abs</span>(observed_mean)))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>boot_p_value</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Interpretation</strong>: The bootstrap results show that the observed mean revision of <strong>11.5 thousand jobs</strong> lies in the extreme tail of the simulated distribution.</p>
<p>Only <strong>0.0003</strong> of bootstrap samples produced a value as extreme as the actual mean revision.</p>
<p>Because this probability is small, the simulation reinforces the conclusion from the classical t-test: <strong>the average CES revision is not zero.</strong> The effect is modest in size, but it is consistently positive, meaning initial estimates tend to be revised slightly upward over time.</p>
</section>
</section>
<section id="conclusion" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Conclusion</h1>
<p>A review of more than four decades of payroll data shows that <strong>CES revisions are a stable, predictable, and well-documented feature</strong> of the employment reporting process. The fact-check analysis demonstrates that common claims about systematic bias or deteriorating data quality are not supported by statistical evidence.</p>
<p><strong>Key Findings from Fact-Check Analysis:</strong></p>
<ul>
<li><strong>Revisions remain small relative to the size of the economy</strong>, with the average revision representing a tiny fraction of total employment</li>
<li><strong>The distribution of revisions is balanced around zero</strong>, with no evidence of systematic overstatement or understatement</li>
<li><strong>Modern revisions are actually smaller and more precise than historical revisions</strong>, contrary to claims of deteriorating quality</li>
<li><strong>Revision patterns correlate with economic conditions rather than administrative or political changes</strong></li>
</ul>
<p>The evidence consistently points to one conclusion: CES revisions reflect <strong>normal statistical processes</strong> rather than systematic bias or manipulation. While periods of economic volatility (such as the pandemic era) can temporarily amplify revision magnitudes, these episodes reflect genuine measurement challenges during turbulent times rather than fundamental problems with data quality.</p>
<p>Overall, the CES revision process demonstrates long-term stability and reliability, providing confidence in one of the nation’s most important economic indicators.</p>
<hr>
<div style="text-align:center; font-size:0.85em; color:gray; margin-top:20px;">
<p>This work ©2025 was initially prepared as a Mini-Project for <strong>STA 9750</strong> at <strong>Baruch College</strong>.<br>More details about the course can be found at the <a href="https://michael-weylandt.com/STA9750/">course site</a>, and full assignment instructions are available under <a href="https://michael-weylandt.com/STA9750/miniprojects/mini04.html">Mini-Project #04</a>.</p>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/shreyakarki71\.github\.io\/STA9750-2025-FALL\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>